- id: config-git-updated
  alias: 'Config Git Repo Updated'
  initial_state: 'on'
  trigger:
    - platform: webhook
      webhook_id: "some_hook_id"
  action:
    - delay: '00:00:15'
    - service: shell_command.git_pull_config
    - service: automation.reload
    - service: logbook.log
      data_template:
        name: "Config Git Repository Updated: "
        message: "{{trigger.to_state.name}} changed from {{trigger.from_state.state}} to {{trigger.to_state.state}} by {{ trigger.to_state.attributes.source }}"
    - service: notify.persistent_notification
      data_template:
        title: Config Reloaded
        message: Configuration reloaded from git repository

- id: hall-sensor
  mode: restart
  alias: Hall Sensor
  initial_state: 'on'
  trigger:
    - type: motion
      platform: device
      entity_id: binary_sensor.hms1_motion
      device_id: 381d86e848b74e791ccbc32aa58ddb90
      domain: binary_sensor
  condition:
    - condition: sun
      after: sunset
  action:
    - service: light.turn_on
      target:
        area_id: hall
    - delay: "00:02:00"
    - service: light.turn_off
      target:
        area_id: hall

- id: return-home
  alias: Return Home
  initial_state: 'on'
  trigger:
    - platform: zone
      entity_id: person.harry
      zone: zone.home
      event: enter
  condition:
    - condition: sun
      after: sunset
  action:
    - service: light.turn_on
      target:
        area_id: living_room
    - service: light.turn_on
      target:
        area_id: hall
- id: sunset
  alias: Sunset
  initial_state: on
  trigger:
    platform: sun
    event: sunset
  condition:
    - platform: zone
      entity_id: person.harry
      zone: zone.home
      event: enter
  action:
    - service: light.turn_on
      target:
        area_id: living_room

- id: turn-off-night
  alias: Turn Everything off At Night
  initial_state: on
  trigger:
    platform: time
    at: "00:00:00"
  action:
    - service: light.turn_off
      entity_id: all