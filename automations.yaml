- id: config-git-updated
  alias: 'Config Git Repo Updated'
  trigger:
    - platform: webhook
      webhook_id: "some_hook_id"
  action:
    - delay: '00:00:15'
    - service: shell_command.git_pull_config
    - service: automation.reload
    - service: logbook.log
      data_template:
        name: "Config Git Repository Updated: "
        message: "{{trigger.to_state.name}} changed from {{trigger.from_state.state}} to {{trigger.to_state.state}} by {{ trigger.to_state.attributes.source }}"
    - service: notify.persistent_notification
      data_template:
        title: Config Reloaded
        message: Configuration reloaded from git repository

- id: hall-sensor
  mode: restart
  alias: Hall Sensor
  trigger:
    - type: motion
      platform: device
      entity_id: binary_sensor.hms1_motion
      device_id: 381d86e848b74e791ccbc32aa58ddb90
      domain: binary_sensor
  condition:
    - condition: sun
      after: sunset
  action:
    - service: light.turn_on
      target:
        area_id: hall
    - delay: "00:02:00"
    - service: light.turn_off
      target:
        area_id: hall

- id: return-home
  alias: Return Home
  trigger:
    - platform: zone
      entity_id: person.harry
      zone: zone.home
      event: enter
  condition:
    - condition: sun
      after: sunset
  action:
    - service: light.turn_on
      target:
        area_id: living_room
    - service: light.turn_on
      target:
        area_id: hall
- id: sunset
  alias: Sunset
  trigger:
    platform: sun
    event: sunset
  condition:
    - condition: zone
      entity_id: person.harry
      zone: zone.home
  action:
    - service: light.turn_on
      target:
        entity_id: light.living_room_ceiling_group
    - service: light.turn_on
      target:
        entity_id: light.hand_lamp

- id: turn-off-night
  alias: Turn Everything off At Night
  trigger:
    platform: time
    at: "00:00:00"
  action:
    - service: light.turn_off
      entity_id: all
    - service: switch.turn_off
      entity_id: all

- id: work-event-start
  alias: Work Event Started
  trigger:
    platform: calendar
    event: start
    offset: "-0:0:0"
    entity_id: calendar.harry_martland_booking_com
  condition:
    - condition: zone
      entity_id: person.harry
      zone: zone.home
  action:
    service: media_player.play_media
    target:
      entity_id: media_player.living_room_speaker
    data:
      media_content_id: media-source://tts/google_translate?message=Next+meeting+starting+now
      media_content_type: provider
    metadata:
      title: Next meeting starting now
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class: null
      navigateIds:
        - {}
        - media_content_type: app
          media_content_id: media-source://tts
        - media_content_type: provider
          media_content_id: media-source://tts/google_translate?message=Next+meeting+starting+now

- id: low-battery
  alias: Low battery level detection & notification for all battery sensors
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      actions:
        - service: notify.notify
          data:
            message: '{{sensors}} is low battery please replace'
            title: Low Battery {{sensors}}

- id: remote-backup
  alias: Remote Backup
  trigger:
    platform: state
    entity_id:
      - schedule.backup
    attribute: next_event
  action:
    - service: hassio.backup_full

- id: on-tv-when-start-playing
  alias: Turn on tv when start playing
  description: ""
  trigger:
    - platform: device
      device_id: a1a0f5a1ab03578cb054a97ed13f2308
      domain: media_player
      entity_id: media_player.living_room_tv
      type: playing
  condition:
    condition: device
    type: is_off
    device_id: 6b00183c77229c552960226987b6c38d
    entity_id: switch.tv
    domain: switch
  action:
    - type: turn_on
      device_id: 6b00183c77229c552960226987b6c38d
      entity_id: switch.tv
      domain: switch
  mode: single

- id: stop-casting-tv-off
  alias: "Stop casting when tv is turn off"
  mode: single
  trigger:
    - platform: device
      type: turned_off
      device_id: 6b00183c77229c552960226987b6c38d
      entity_id: switch.tv
      domain: switch
  action:
    - service: media_player.turn_off
      data: {}
      target:
        device_id: a1a0f5a1ab03578cb054a97ed13f2308

- id: vacuum-noone-home
  alias: Vacuum When No-One is Home
  description: ""
  trigger:
    - platform: state
      entity_id:
        - schedule.vacuum_schedule
      attribute: next_event
  condition:
    - condition: not
      conditions:
        - condition: zone
          entity_id: person.harry
          zone: zone.home
  action:
    - device_id: e57e470cea06bb5dae71dfe8cf17af60
      domain: vacuum
      entity_id: vacuum.becki
      type: clean
  mode: single

- id: "bed-time"
  alias: "Bed Time"
  description: "Bed time, turn on bedroom side lights"
  mode: single
  trigger:
    - platform: time
      at: "22:00:00"
  condition:
    - condition: zone
      entity_id: person.harry
      zone: zone.home
  action:
    - service: light.turn_on
      target:
        entity_id: light.side_lamp_group
    - service: light.turn_off
      target:
        entity_id: light.hand_lamp
